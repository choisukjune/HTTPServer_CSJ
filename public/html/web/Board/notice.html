

<include>_header_info.html</include>
<script>window.service.session.checkSession();</script>
<include>navi.html</include>
<style>
#container
{
	left: 0px !important; right: 0px !important; bottom: 0px !important; top: 0px !important;
}
#content
{
	left: 0px !important; right: 0px !important; bottom: 0px !important; top: 0px !important;
}
#list
{
	cursor: pointer;
	padding : 30px;
	margin : 0px !important;border-bottom : 1px solid rgba(34, 36, 38, 0.15) !important;
}
#list:last-child
{
	cursor: pointer;
	padding : 30px;
	margin : 0px !important;
}
#notebook_list_item
{
	cursor: pointer;
	padding : 30px;
	margin : 0px !important;border-bottom : 1px solid rgba(34, 36, 38, 0.15) !important;
}
#notebook_list_item:last-child
{
	cursor: pointer;
	margin : 0px !important;border-bottom : 1px solid rgba(34, 36, 38, 0.15) !important;
	padding : 30px;
}
#notebook_add_container
{
	cursor: pointer;
	margin : 0px !important;
	background-color: #eee;
}
#notebook_add_container:last-child
{
	margin : 0px !important;border-bottom : 0 !important;
}
#note_add_container
{
	cursor: pointer;
	margin : 0px !important;
	background-color: #eee;
}
#note_add_container:last-child
{
	margin : 0px !important;border-bottom : 0 !important;
}
.bottom_line
{
	margin : 0px !important;border-bottom : 1px solid rgba(34, 36, 38, 0.15) !important;
}
.bg_color_eee
{
	background-color: #eee !important;
}
.sidebar{
	box-shadow :none !important;
}
#project_list_container{
	overflow-y : auto !important;
	height : 850px;
}

#notebook_list,#sub_list{
	margin : 0px;
	overflow-y: auto !important;
	/* min-height:700px;max-height:700px;height: 700px; */
}
</style>
<!-- <div class="ui centered grid">
	<div class="twelve wide column pad_t_60 pad_b_60"> -->

	<!----- contents ----->


	<div id="container" class="ui container">
		<!-- 2 -->
		<div class="ui horizontal segments" style="left: 0px !important; right: 0px !important; bottom: 0px !important; top: 0px !important; position: absolute; margin: 0px;overflow-y: hidden !important;">

			<!-- 3 -->
			<div id="div-PIMS-menu-list" class="ui vertical icon menu segment" style="padding : 0px; min-width: 40px !important; max-width: 40px !important; overflow-y: auto !important;">
				<a class="item" style="padding : 13px !important;" id="global_sidebar">
					<i class="bars fitted icon"  style="margin : 0px !important;"></i>
				</a>
				<a class="item" style="padding : 13px !important;" id="project_add">
					<i class="plus circle fitted icon"  style="margin : 0px !important;"></i>
				</a>
				<a class="item" style="padding : 13px !important;" id="test_sidebar1">
					<i class="check square fitted icon"  style="margin : 0px !important;"></i>
				</a>
				<a class="item" style="padding : 13px !important;" id="test_sidebar">
					<i class="comment fitted icon"  style="margin : 0px !important;"></i>
				</a>
				<a class="item" style="padding : 13px !important;" id="test_flip">
						<i class="list ul fitted icon"  style="margin : 0px !important;"></i>
				</a>
				<a class="item" style="padding : 13px !important;" id="project_list_view_btn">
						<i class="file alternate fitted icon"  style="margin : 0px !important;"></i>
				</a>
			</div>

			<!-- 좌측 레이아웃이 더필요하다면 사용; -->
			<!--

			<div id="div-PIMS-menu-list" class="ui vertical menu segment" style="padding : 0px; min-width: 270px !important; max-width: 270px !important; overflow-y: auto !important;">

			</div>

			-->
			<!-- 좌측 레이아웃이 더필요하다면 사용; -->

			<div id="div-PIMS-VerticalContainer" class="ui fluid basic segment" style="min-height: auto !important; max-height: 100% !important;overflow-y : hidden !important;">

					<div id="div-PIMS-GridContainer" class="ui grid" style="height : auto !important;">
						<div id="div-PIMS-HeaderContainer"class="sixteen wide fixed column" style="background-color : #303841">
							<div class="ui red horizontal label">Notice!</div>
							<a class="avatar">
								<img class="ui avatar Mini image" src="https://semantic-ui.com/images/avatar/small/elliot.jpg">
							</a>
						</div>
						<div class="sixteen wide column" id="div-PIMS-ViewContainer" style="min-height: 848px !important;">
							<div class="ui grid">
								<div class="sixteen wide column" id="project_list_container" style="width: 100%;">
										<div class="ui basic segment">
											<div class="ui cards" id="project_list"></div>	
										</div>
								</div>
								<!--Content-->
								<div class="sixteen wide column" style="border-right : 1px solid rgba(34, 36, 38, 0.15) !important;padding : 0px !important;overflow-y: auto !important; min-height: 848px !important;height: 848px !important;">
									<div id="app">
										<div class="ui left 700 wide sidebar">
											<div class="ui grid" style="margin : 0px;padding : 0px; background-color:#fff;overflow-y: hidden !important;">
													<div class="eight wide column" style="border-right : 1px solid rgba(34, 36, 38, 0.15) !important;padding : 0px !important;min-height: 848px !important;height: 848px !important;">
														<div id="notebook_add_container" class="ui basic segment item">
															<div class="ui grid">
																<div class="sixteen wide column" id="project_title_div" style="padding : 0px;">
																	<div class="ui items">
																		  <div class="item" style="padding : 30px;margin : 0px;">
																			<div class="content">
																				<div class="header" id="project_title" style="max-width : 80%;"></div>
																				<div class="ui right floated mini icon button" id="notebook_add"><i class="plus icon"></i></div>
																				<div class="ui right floated mini icon button" id="project_title_modify_btn"><i class="file alternate icon"></i></div>
																				<div class="description" id="project_desc"></div>
																			</div>
																		  </div>
																	  </div>
																</div>
															</div>
														</div>
														<div class="ui items" id="notebook_list"></div>
															<!-- <div id="list" class="ui basic segment item">
																<b>본문요약입니다.</b>
															</div>
															<div id="list" class="ui basic segment item">
																<b>본문요약입니다.</b>
															</div>
															<div id="list" class="ui basic segment item">
																<b>본문요약입니다.</b>
															</div> -->
													</div>
													<div class="eight wide column" style="border-right : 1px solid rgba(34, 36, 38, 0.15) !important;padding : 0px !important;min-height: 848px !important;height: 848px !important;">
														<div id="note_add_container" class="ui basic segment item" style="display : none;">
															<div class="ui grid">
																<div class="sixteen wide column" id="notebook_title_div"  style="padding : 0px;">
																	<div class="ui items">
																		<div class="item" style="padding : 30px;margin : 0px;">
																		  <div class="content">
																			<div class="header" id="notebook_title" style="max-width : 80%;"></div>
																			<div class="ui right floated mini icon button" id="note_add"><i class="plus icon"></i></div>
																			<div class="ui right floated mini icon button" id="notebook_title_modify_btn"><i class="file alternate icon"></i></div>
																			<div class="description" id="notebook_desc"></div>
																		  </div>
																		</div>
																	</div>
																</div>
															</div>
														</div>
														<div id="sub_list"  class="ui items"></div>
														<!-- <div id="list" class="ui basic segment item">
															<h4>제목입니다.</h4>
															<p>본문요약입니다.</p>
														</div>
														<div id="list" class="ui basic segment item">
															<h4>제목입니다.</h4>
															<p>본문요약입니다.</p>
														</div>
														<div id="list" class="ui basic segment item">
															<h4>제목입니다.</h4>
															<p>본문요약입니다.</p>
														</div> -->
													</div>
												</div>
											</div>
											<div class="pusher">
												<div class="ui grid container" style="padding:0px;margin:0px;">
													<div class="sixteen wide column" style="overflow-y: auto !important;padding : 0px !important;overflow-y: auto !important; max-height: 848px !important;">
														<div class="ui basic segment" id="view_container" style="min-height : 738px"></div>
														<div class="ui basic segment" style="margin : 0px">
															<div class="ui buttons">
																<button class="ui button" id="modify" style="display : none;">수정</button>
																<button class="ui button" id="delete" style="display : none;">삭제</button>
																<button class="ui button" id="cancel" style="display : none;">취소</button>
																<button class="ui button" id="lists" style="display : none;">목록</button>
																<button class="ui button" id="write" style="display : none;">등록</button>
															</div>
														</div>
													</div>
												</div>
											</div>
									</div>
								</div>
						</div>
					</div>
					<!-- <div id="div-PIMS-FooterContainer" class="sixteen wide column"style="background-color : #eeeeee; bottom : 0px !important;position : relative !important;border-top : 1px solid rgba(34, 36, 38, 0.15) !important;">Copyright © B2LABS All Rights Reserved.</div> -->
					<div class="ui footer basic segment" style="background-color: #eee !important;" id="footer">
						<div class="ui container">
							<p>
								Place sticky footer content here.
							</p>
						</div>
					</div>	
				</div>
			</div>
		</div>
	</div>
	<!----- contents ----->

	<!-- 프로젝트 추가 모달 -->

	<div class="ui mini modal transition" id="project_add_modal">
		<div class="header" id="modal_project_header"></div>
		<div class="content">
			<div class="ui form">
				<div class="field">
					<label>Project Name</label>
					<input type="text" name="projec-name" placeholder="Project Name" id="modal_project_nm">
				</div>
				<div class="field">
					<label>Description</label>
					<textarea id="modal_project_desc"></textarea>
				</div>
				<div class="field" id="project_add_write_field">
					<button class="green fluid ui button" id="project_add_write">Add</button>
				</div>
				<div class="field" id="project_update_btn_field">
					<button class="orange fluid ui button" id="project_update_btn">Modify</button>
				</div>
				<div class="field">
					<button class="fluid ui button"  id="project_add_cancel">Cancel</button>
				</div>
			</div>
		</div>
	</div>

	<!-- 프로젝트 추가 모달 -->

	<!-- 노트북 추가 모달 -->

	<div class="ui mini modal transition" id="notebook_add_modal">
		<div class="header">
			Notebook Add.
		</div>
		<div class="content">
			<div class="ui form">
				<div class="field">
					<label>Notebook Name</label>
					<input type="text" name="notebook-name" placeholder="Notebook Name" id="modal_notebook_nm">
				</div>
				<div class="field">
					<label>Description</label>
					<textarea id="modal_notebook_desc"></textarea>
				</div>
				<div class="field" id="notebook_add_write_field">
					<button class="green fluid ui button" id="notebook_add_write">Add</button>
				</div>
				<div class="field" id="notebook_update_btn_field">
					<button class="orange fluid ui button" id="notebook_update_btn">Modify</button>
				</div>
				<div class="field">
					<button class="fluid ui button" id="notebook_add_cancel">Cancel</button>
				</div>
			</div>
		</div>
	</div>

	<!-- 노트북 추가 모달 -->

<include>_footer_info.html</include>

<script type="text/javascript">

window.service.domStorage = {};
 
// secondary menu
// $('.secondary.menu .ui.sidebar')
//   .sidebar({ context: $('.bottom.segment') })
//   .sidebar('attach events', '.secondary.menu .item')
//   .sidebar('setting', 'transition', 'push')
//   .sidebar('setting', 'dimPage', false)


//editor 라이브러리 로드;
var sNew = document.createElement("script");
sNew.async = true;
sNew.src = "libs/ckeditor/ckeditor.js";
var s0 = document.getElementsByTagName('script')[0];
s0.parentNode.insertBefore(sNew, s0);
//editor 라이브러리 로드;

//--------------------------------------------------variable;
var notebook_detail_data = [];
var project_list_data = [];
var notebook_list_data = [];

var current_view_doc__data = {};
var current_project__data = {};
var current_notebook__data = {};
var current_note_chat__data = {};
var current_note_todo__data = {};

var pre_objDiv_scrollHeight = 0;
//------------------------------_el;
var _el_div__view_container = document.getElementById("view_container");
var _el_div__sub_list = document.getElementById('sub_list')
var _el_btn__project_add = document.getElementById( "project_add" );
var _el_btn__notebook_add = document.getElementById( "notebook_add" );
var _el_btn__project_add_write = document.getElementById( "project_add_write" )
var _el_btn__project_add_cancel = document.getElementById( "project_add_cancel" )
var _el_btn__notebook_add_write = document.getElementById( "notebook_add_write" )
var _el_btn__notebook_add_cancel = document.getElementById( "notebook_add_cancel" )
//------------------------------_el;
/*
	//ToDo 정리해야할 함수;
	function htmlEntities(str) {
	    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
	}

	function htmlEntities3(str) {
	    return String(str).replace(/(\S+)=["']?((?:.(?!["']?\s+(?:\S+)=|[>"']))+.)["']?/g, '')
		.replace(/^<table.*[">$]/g, '<table class="ui celled table">')
		.replace(/<span >/g, '')
		.replace(/<\/span>/g, '')
		.replace(/<td >/g, '<td>')
		.replace(/&nbsp;/g, '')
	//	.replace(//g, '<td>')
	}
*/

//--------------------------------------------------function;
var _el_removeChild = function( el ){
	if( el.firstChild ) while( el.firstChild ) el.removeChild( el.firstChild );
}
/**
*
*/
var htmlEntities =  function(str){
	//return String(str).replace(/(\S+)=["']?((?:.(?!["']?\s+(?:\S+)=|[>"']))+.)["']?/g, '')
	return String(str).replace(/\"/g, "'")
	.replace(/&quot;/g, "'")
	//.replace(/^<table.*[">$]/g, '<table class="ui celled compact table">')
	//.replace(/<table/g, '<table class="ui celled compact table" ')
	// .replace(/<span >/g, '')
	// .replace(/<\/span>/g, '')
	// .replace(/<td >/g, '<td>')
	.replace(/&nbsp;/g, '')
	//.replace(/\&/g, '&amp;');
//	.replace(//g, '<td>')
};

/**
*
*/
var make_Array_dateFormat = function( arr ){
	return arr[ 0 ] + "." + arr[ 1 ] + "."+ arr[ 2 ] + " "+ arr[ 3 ] + ":"+ arr[ 4 ] + ":"+ arr[ 5 ];
}
/**
 * [write_doc description]
 * @type {[type]}
 */
 var check_dom = function( e, str, p0){
	 if( e.getAttribute("id") == str ) return e
	 else if( e.getAttribute("id") == p0 ) return "";
	 else return check_dom( e.parentElement, str, p0 )
 }

var btn_object = { modify : "none", delete : "none", delete : "none", cancel : "none", lists : "none", write : "none"}

var btn_control = function( o ){
	for( var s in btn_object )
	{
		if( o[ s ] ) document.getElementById( s ).style.display = o[ s ];
		else document.getElementById( s ).style.display = btn_object[ s ];
	}
	return;
}

/**
 * 
*/
var detect_scrollHeight = function( d ){
	return d.scrollHeight
}

/**
 * 
*/
var project_sub_nav_sidebar_open = function(){
	$('#app .ui.sidebar')
	.sidebar({context:$('#app')})
	.sidebar('setting', 'transition', 'push')
	.sidebar('setting', 'dimPage', false)
	.sidebar('setting', 'closable', false)
	.sidebar('show')
}
//--------------------------------------------------function;

//------------------------------ event;
document.getElementById("global_sidebar").addEventListener("click",function(){
	$('#global_LNB_sidebar')
	.sidebar('setting', 'transition', 'push')
	.sidebar('toggle');
})

document.getElementById("notebook_list").addEventListener("click",function(e){

	var pe = e.currentTarget.children
	var te = check_dom( e.target, "notebook_list_item", "notebook_list" )

	var i = 0,iLen = pe.length,io;
	for(;i < iLen;++i){
		io = pe[ i ]
		if( io == te )
		{
			console.log( i )
			if( check_dom(e.target,"notebook_list_delete_btn","notebook_list_item").id == "notebook_list_delete_btn")
			{
				console.log('notebook_list_delete_btn')
				delete_notebook( notebook_list_data[ i ]._id )

				document.getElementById("note_add_container").setAttribute("style","display : none;")
				document.getElementById("notebook_title").innerText = "";

				document.getElementById("project_list_container").style.display ="none";
				document.getElementById("app").style.display = "block";
				make_notebook_list( current_project__data.cd );
				
				return;
			}
			else if( check_dom(e.target,"notebook_list_modify_btn","notebook_list_item").id == "notebook_list_modify_btn")
			{
				console.log('notebook_list_modify_btn')
				notebook_modify( notebook_list_data[ i ] )
				return;
			}		
			else
			{
				current_notebook__data = notebook_list_data[ i ]

				document.getElementById("note_add_container").setAttribute("style","display : block;")
				document.getElementById("notebook_title").innerText = current_notebook__data.nm
				document.getElementById("notebook_desc").innerText = current_notebook__data.description

				make_sub_list( current_notebook__data.cd );

				var _t0 = document.getElementById( "view_document" )
				if( _t0 ) if( document.getElementById("view_document").firstChild ) while( document.getElementById("view_document").firstChild ) document.getElementById("view_document").removeChild( _t0.firstChild );

				//make_brcm_2();
			}
		}
	}
	//----------;
	var btn_control_obj = {};
	btn_control( btn_control_obj );
	//----------;
})


var notebook_modify = function( d ){

	$('#notebook_add_modal').modal('show');
	console.log("modify_notebook")
	
	document.getElementById("notebook_add_write_field").style.display = "none";
	document.getElementById("notebook_update_btn_field").style.display = "block";
	document.getElementById("modal_notebook_nm").value = d.nm;
	document.getElementById("modal_notebook_desc").value = d.description;

	document.getElementById("notebook_update_btn").addEventListener("click",function(){
		var _uo;
		_uo = d
		_uo.nm = document.getElementById("modal_notebook_nm").value;
		_uo.description = document.getElementById("modal_notebook_desc").value;
		console.log( _uo )
		
		update_notebook( _uo );
	})

}

var project_modify = function( d ){
	document.getElementById("project_update_btn").removeEventListener("click",function(){
		var _uo;
		_uo = d
		_uo.nm = document.getElementById("modal_project_nm").value;
		_uo.description = document.getElementById("modal_project_desc").value;
		console.log( _uo )
		
		update_project( _uo );
	})
	document.getElementById("modal_project_header").innerText = "Project Modify."
	document.getElementById("project_add_write_field").style.display = "none";
	document.getElementById("project_update_btn_field").style.display = "block";
	document.getElementById("modal_project_nm").value = d.nm;
	document.getElementById("modal_project_desc").value = d.description;

	$('#project_add_modal').modal('show');
	console.log("modify_project")
}


document.getElementById("project_update_btn").addEventListener("click",function(){
	var _uo;
	_uo = d
	_uo.nm = document.getElementById("modal_project_nm").value;
	_uo.description = document.getElementById("modal_project_desc").value;
	console.log( _uo )
	
	update_project( _uo );
})

document.getElementById("notebook_title_modify_btn").addEventListener("click",function(){
	notebook_modify( current_notebook__data )
})

_el_btn__notebook_add_cancel.addEventListener("click",function(){
	document.getElementById( "modal_notebook_nm" ).value = "";
	document.getElementById( "modal_notebook_desc" ).value = "";
	document.getElementById("notebook_add_write_field").style.display = "block";
	document.getElementById("notebook_update_btn_field").style.display = "none";

	$('#notebook_add_modal').modal('hide');
})

document.getElementById( "project_title_div" ).addEventListener("click",function(){
	$('#project_select_modal').modal('setting', 'closable', true).modal('show');
})

_el_btn__project_add_cancel.addEventListener("click",function(){
	document.getElementById( "modal_project_nm" ).value = "";
	document.getElementById( "modal_project_desc" ).value = "";
	$('#project_add_modal').modal('hide');
})

_el_btn__project_add.addEventListener("click",function(){

	document.getElementById("modal_project_header").innerText = "Project Add."
	document.getElementById( "modal_project_nm" ).value = "";
	document.getElementById( "modal_project_desc" ).value = "";
	document.getElementById("project_add_write_field").style.display = "block";
	document.getElementById("project_update_btn_field").style.display = "none";

	$('#project_add_modal').modal('show');
	console.log("_el_btn__project_add")
	_el_btn__project_add_write.addEventListener("click", write_project );
})

_el_btn__notebook_add.addEventListener("click",function(){
	$('#notebook_add_modal').modal('toggle');
	console.log("_el_btn__project_add")
	document.getElementById( "modal_notebook_nm" ).value = "";
	document.getElementById( "modal_notebook_desc" ).value = "";
	document.getElementById("notebook_add_write_field").style.display = "block";
	document.getElementById("notebook_update_btn_field").style.display = "none";

	_el_btn__notebook_add_write.addEventListener("click",write_notebook );
})

document.getElementById("test_sidebar").addEventListener("click",function(){
	_el_removeChild( document.getElementById("comment_container") );

	$('.ui.right.sidebar.comment_sidebar').sidebar('setting', 'transition', 'overlay').sidebar("show", function(){

	current_note_chat__data[ current_view_doc__data.cd ] = { data : [], limit : 20, skip : 0 };

	document.getElementById("comment_wrap").setAttribute("style","background-color : #fff;;min-height : 769px;max-height : 769px; height:769px;overflow-y : auto;")
	pre_objDiv_scrollHeight = 0
	
	chat_board_get_list();

	})
})

document.getElementById("test_flip").addEventListener("click", function(){
	$('#app .ui.sidebar')
	.sidebar({context:$('#app')})
	.sidebar('setting', 'transition', 'push')
	.sidebar('setting', 'dimPage', false)
	.sidebar('setting', 'closable', false)
	.sidebar('toggle')
});

document.getElementById("test_sidebar1").addEventListener("click",function(){
	_el_removeChild( document.getElementById("todo_container") );notebook_
	$('#multi-select').dropdown();
	$('.ui.right.sidebar.todo_sidebar').sidebar('setting', 'transition', 'overlay').sidebar("show",function(){
		
	current_note_todo__data[ current_view_doc__data.cd ] = { data : [], limit : 20, skip : 0 };

	document.getElementById("todo_wrap").setAttribute("style","background-color : #fff;;min-height : 664px;max-height : 664px;height :664px;overflow-y : auto;")
	pre_objDiv_scrollHeight = 0
	
	todo_board_get_list();

	})
})

document.getElementById("comment_wrap").addEventListener("scroll",function(){
	var comment_wrap = document.getElementById("comment_wrap");
	if( comment_wrap.scrollTop == 0 )
	{
		current_note_chat__data[ current_view_doc__data.cd ].skip += 20
		chat_board_get_list()
	}
})

document.getElementById("todo_wrap").addEventListener("scroll",function(){
	var todo_wrap = document.getElementById("todo_wrap");
	if( todo_wrap.scrollTop == 0 )
	{
		current_note_todo__data[ current_view_doc__data.cd ].skip += 20
		todo_board_get_list()
	}
})

var _el_div__sub_list_click = function(e){


		var pe = e.currentTarget.children
		var te = check_dom( e.target, "list", "sub_list" )

		var i = 0,iLen = pe.length,io;
		for(;i < iLen;++i){
			io = pe[ i ]
			if( io == te ){
				console.log( i )
				if( check_dom(e.target,"sub_list_delete_btn","list").id == "sub_list_delete_btn")
				{
					console.log('sub_list_delete_btn')
					delete_doc( notebook_detail_data[ i ]._id )
					make_sub_list( current_notebook__data.cd );

					var _t0 = document.getElementById( "view_document" )
					if( _t0 ) if( document.getElementById("view_document").firstChild ) while( document.getElementById("view_document").firstChild ) document.getElementById("view_document").removeChild( _t0.firstChild );
					return;
				}
				else
				{
					return req_detail_by__id( notebook_detail_data[ i ]._id )
				}
			}
		}
}


var _el_div_prject_list_click = function(e){
					
	var pe = e.currentTarget.children
	var te = check_dom( e.target, "project_list_card", "project_list_container" )

	if( check_dom(e.target,"project_list_delete_btn","project_list_card").id == "project_list_delete_btn")
	{
		var i = 0,iLen = pe.length,io;
		for(;i < iLen;++i){
			io = pe[ i ]
			if( io == te ){
				console.log( i )
				console.log('project_list_delete_btn')
				delete_project( project_list_data[ i ]._id )
			}
		}
		return;
	}
	else if( check_dom(e.target,"project_list_modify_btn","project_list_card").id == "project_list_modify_btn")
	{		
		var i = 0,iLen = pe.length,io;
		for(;i < iLen;++i){
			io = pe[ i ]
			if( io == te ){
				console.log( i )
				console.log('project_list_delete_btn')
				project_modify( project_list_data[ i ] )
			}
		}
		return;
	}	
	else
	{
		var i = 0,iLen = pe.length,io;
		for(;i < iLen;++i){
			io = pe[ i ]
			if( io == te ){
				console.log( i )
				document.getElementById("note_add_container").setAttribute("style","display : none;")
				document.getElementById("notebook_title").innerText = "";


				current_project__data = project_list_data[ i ];
				document.getElementById( "project_title" ).innerText = current_project__data.nm
				document.getElementById( "project_desc" ).innerText = current_project__data.description
				document.getElementById("project_list_container").style.display ="none";
				document.getElementById("app").style.display = "block";
				make_notebook_list( current_project__data.cd );
			}
		}
		return;
	}
}
document.getElementById("project_list_view_btn").addEventListener("click",function(){

	document.getElementById("app").style.display = "none";
	make_project_list();
})

//------------------------------ event;
//------------------------------ addEventListener;
_el_div__sub_list.addEventListener("click",_el_div__sub_list_click)
//------------------------------ addEventListener;
//--------------------------------------------------variable;

/**
 * 채팅사이드바의 채팅리스트를 그린다.
*/
var render_chat_data = function( arr, cbFunction ){
	var _el = document.getElementById("comment_container");

	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "render_chat_data.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		
		var _template = result;

		var i = 0,iLen = arr.length,io;
		for(;i<iLen;++i)
		{

			io = arr[ i ];
			var broadcast_msg = "";
			var msg = io.content;
			if( msg.indexOf("\n") != -1)
			{
				var _ta = msg.split("\n")
				var j = 0,jLen = _ta.length,jo;
				for(;j<jLen;++j)
				{
					jo = _ta[ j ];
					broadcast_msg += "<p>" + jo + "</p>\n";
				}

			}
			else
			{
				broadcast_msg = "<p>" + msg + "</p>";
			};

			var html_include_data = _template.replace( "{{image_url}}", io.member.image )
			.replace( "{{author}}", io.member.nm )
			.replace( "{{regist_date}}", make_Array_dateFormat( io.regist_date ) )
			.replace( "{{content}}", broadcast_msg );

			_el.insertAdjacentHTML( 'beforeend', html_include_data );
		}

		cbFunction();
	});
};


/**
 * 채팅사이드바의 채팅리스트를 그린다.
*/
var render_todo_data = function( arr, cbFunction ){
	var _el = document.getElementById("todo_container");

	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "render_todo_data.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		
		var _template = result;

		var i = 0,iLen = arr.length,io;
		for(;i<iLen;++i)
		{
			io = arr[ i ];
			
			//------------------------------ tag;

			var label_source = "<div class='ui label'>{{label}}</div>"
			var include_source = "";
			var j = 0,jLen = io.cd$tag.length,jo,label;
			for(;j<jLen;++j)
			{
				
				jo = io.cd$tag[ j ]
				label = label_source
				label = label.replace("{{label}}", jo )

				include_source += label;

				// _el_label.insertAdjacentHTML( 'beforeend', label );
			
			}
			//------------------------------ tag;

			
			var html_include_data = _template.replace( "{{title}}", io.title )
			.replace( "{{image_url}}", io.member.image )
			.replace( "{{memberNm}}", io.member.nm )
			.replace( "{{regist_date}}", make_Array_dateFormat( io.regist_date ) )
			.replace( "{{content}}", io.content )
			.replace("{{label_con}}",include_source);

			_el.insertAdjacentHTML( 'beforeend', html_include_data );

		}

		cbFunction();
	});
};


/**
 * 각문서의 채팅리스트를 가져온다
*/
var chat_board_get_list = function(){

	var url = "/api/Chat/board/get_list?sid=" + window.service.cookie.getCookie('session') 
			+ "&cd$doc=" + current_view_doc__data.cd
			+ "&limit=" + current_note_chat__data[ current_view_doc__data.cd ].limit
			+ "&skip=" + current_note_chat__data[ current_view_doc__data.cd ].skip;

	window.service.Request.req_GET_data__Callback(url,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login()

		var data = JSON.parse( result );
		
		render_chat_data( data, function(){
			
			var objDiv = document.getElementById("comment_wrap")
			var cur_objDiv_scrollHeight = objDiv.scrollHeight - pre_objDiv_scrollHeight;

			objDiv.scrollTop =  cur_objDiv_scrollHeight;
			pre_objDiv_scrollHeight = objDiv.scrollHeight;
		} );



		current_note_chat__data[ current_view_doc__data.cd ].data.push( data );
	})
}


/**
 * 각문서의 채팅리스트를 가져온다
*/
var todo_board_get_list = function(){

var url = "/api/Todo/board/get_list?sid=" + window.service.cookie.getCookie('session') 
		+ "&cd$doc=" + current_view_doc__data.cd
		+ "&limit=" + current_note_todo__data[ current_view_doc__data.cd ].limit
		+ "&skip=" + current_note_todo__data[ current_view_doc__data.cd ].skip;

	window.service.Request.req_GET_data__Callback(url,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login()

		var data = JSON.parse( result );
		
		render_todo_data( data, function(){
			
			var objDiv = document.getElementById("todo_wrap");
			var cur_objDiv_scrollHeight = objDiv.scrollHeight - pre_objDiv_scrollHeight;

			objDiv.scrollTop =  cur_objDiv_scrollHeight;
			pre_objDiv_scrollHeight = objDiv.scrollHeight;

		} );;
		// var objDiv = document.getElementById("todo_container")
		// var cur_objDiv_scrollHeight = objDiv.scrollHeight - pre_objDiv_scrollHeight;

		// objDiv.scrollTop =  cur_objDiv_scrollHeight;
		// pre_objDiv_scrollHeight = objDiv.scrollHeight;

		current_note_todo__data[ current_view_doc__data.cd ].data.push( data );
	})
}

/**
 * 1뎁스 breadScrumb을 만든다.
*/
var make_brcm_1 = function(){
	var _t0 = document.getElementById("brscm")

	if( document.getElementById( "brscm_1" ) )
	{
		//document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_1" ) );
		if( current_project__data ) document.getElementById( "brscm_1" ).innerText = current_project__data.nm;
		if( document.getElementById( "brscm_2" ) ) document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_2" ) );
		if( document.getElementById( "brscm_3" ) ) document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_3" ) );
		if( document.getElementById( "brscm_2_divider" ) ) document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_2_divider" ) );
		if( document.getElementById( "brscm_3_divider" ) ) document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_3_divider" ) );
	}
	else
	{
		var a = document.createElement("a")
			a.setAttribute("class","section");
			a.setAttribute("id","brscm_1");
			a.appendChild( document.createTextNode( current_project__data.nm ) );

		_t0.appendChild( a )
	}
}

/**
 * 2뎁스 breadScrumb을 만든다.
*/
var make_brcm_2 = function(){
	var _t0 = document.getElementById("brscm")

	if( document.getElementById( "brscm_2" ) )
	{
		//document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_2" ) );
		document.getElementById( "brscm_2" ).innerText = current_notebook__data.nm;
		if( document.getElementById( "brscm_3_divider" ) ) document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_3_divider" ) );
		if( document.getElementById( "brscm_3" ) ) document.getElementById( "brscm" ).removeChild( document.getElementById( "brscm_3" ) );
	}
	else
	{
		var a = document.createElement("a")
			a.setAttribute("class","section");
			a.setAttribute("id","brscm_2");
			a.appendChild( document.createTextNode( current_notebook__data.nm ) );

		var i = document.createElement("i")
			i.setAttribute("class","right chevron icon divider");
			i.setAttribute("id","brscm_2_divider");

		_t0.appendChild( i )
		_t0.appendChild( a )
	}

}

/**
 * 3뎁스 breadScrumb을 만든다.
*/
var make_brcm_3 = function(){
	var _t0 = document.getElementById("brscm")

	if( document.getElementById( "brscm_3" ) )
	{
		document.getElementById( "brscm_3" ).innerText = current_view_doc__data.title;
	}
	else
	{
		var a = document.createElement("a")
			a.setAttribute("class","section");
			a.setAttribute("id","brscm_3");
			a.appendChild( document.createTextNode( current_view_doc__data.title ) );

		var i = document.createElement("i")
			i.setAttribute("class","right chevron icon divider");
			i.setAttribute("id","brscm_3_divider")

		_t0.appendChild( i )
		_t0.appendChild( a )
	}
}

/**
 * 프로젝트 리스트를 그린다.
*/
var make_project_list = function(){
	
	_el_removeChild( document.getElementById("project_list") );

	_el_btn__project_add_write.removeEventListener("click",write_project);
	document.getElementById("project_list").removeEventListeners("click",_el_div_prject_list_click )

	document.getElementById("app").style.display = "none";

	_el_removeChild( document.getElementById( "notebook_list" ));
	_el_removeChild( document.getElementById( "sub_list" ));
	_el_removeChild( document.getElementById( "view_container" ));

	document.getElementById( "project_list_container" ).setAttribute("style","display : block;")
	_el_removeChild( document.getElementById("project_list"))


	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "make_project_list.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		
		var _template = result;
		
		var url = "/api/Category/project/get_list?sid=" + window.service.cookie.getCookie('session');
		window.service.Request.req_GET_data__Callback(url,function(result){
			if(result == 0) window.service.session.remove_deleteCookies_location_login();

			var data = JSON.parse( result );

			console.log( data );
			project_list_data = data;


			document.getElementById( "notebook_add_container" ).setAttribute( "style", "display : none;" )
			document.getElementById( "note_add_container" ).setAttribute( "style", "display : none;" )

			_el_removeChild( document.getElementById("notebook_list") );

			var i = 0,iLen = data.length,io
			for(;i<iLen; ++i)
			{
				io = data[ i ];
				
				var html_include_data = _template.replace( "{{nm}}", io.nm )
				.replace( "{{description}}", io.description )
				.replace( "{{regist_date}}", make_Array_dateFormat( io.regist_date ) );

				document.getElementById("project_list").insertAdjacentHTML( 'beforeend', html_include_data );
			}

			document.getElementById("project_list").addEventListener("click",_el_div_prject_list_click )

		})

	})
}

/**
 * 노트북 리스트를 만든다.
*/
var make_notebook_list = function( cd$project ){

	_el_btn__notebook_add_write.removeEventListener("click",write_notebook);

	var _t0 = document.getElementById("notebook_list")

	if( _t0.firstChild ) while( _t0.firstChild ) _t0.removeChild( _t0.firstChild );

	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "make_notebook_list.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		
		var _template = result;

		var url = "/api/Category/notebook/get_list?sid=" + window.service.cookie.getCookie('session') + "&cd$project=" + cd$project;
		window.service.Request.req_GET_data__Callback(url,function(result){
			if(result == 0) window.service.session.remove_deleteCookies_location_login();

			var data = JSON.parse( result );

			notebook_list_data = data;

			//노트북리스트 초기화;
			var _el_div__sub_list = document.getElementById( "sub_list" )
			if( _el_div__sub_list ) if( _el_div__sub_list.firstChild ) while( _el_div__sub_list.firstChild ) _el_div__sub_list.removeChild( _el_div__sub_list.firstChild );
			var _el_div__view_container = document.getElementById( "view_document" )
			if( _el_div__view_container ) if( _el_div__view_container.firstChild ) while( _el_div__view_container.firstChild ) _el_div__view_container.removeChild( _el_div__view_container.firstChild );

			document.getElementById( "notebook_add_container" ).setAttribute( "style", "display : block;" )

			//----- 리스트높이 자동조절;
			var _h = document.body.clientHeight;
			var header_h = document.getElementById("div-PIMS-HeaderContainer").scrollHeight;
			var footer_h = document.getElementById("footer").scrollHeight;
			var notebook_add_h = document.getElementById("notebook_add_container").scrollHeight;
			
			document.getElementById("notebook_list").style.height = _h - notebook_add_h - header_h - footer_h;
			//----- 리스트높이 자동조절;

			_el_removeChild( _t0 );

			var i = 0,iLen = data.length,io
			for(;i<iLen; ++i)
			{
				io = data[ i ];
				
				var html_include_data = _template.replace( "{{nm}}", io.nm )
				.replace( "{{description}}", io.description )
				.replace( "{{regist_date}}", make_Array_dateFormat( io.regist_date ) );

				_t0.insertAdjacentHTML( 'beforeend', html_include_data );
			}
			//----------;
			var btn_control_obj = {};
			btn_control( btn_control_obj );
			//----------;

			project_sub_nav_sidebar_open();
			document.getElementById("notebook_list_modify_btn").addEventListener("click",function(){
				$('#notebook_add_modal').modal('toggle');
				console.log("notebook_list_modify_btn")
			})
		})
	})

	
}

/**
* 리스트의 문서디테일을 가져와 화면에 그린다.
*/
var req_detail_by__id = function( _id ){
	var url = "/api/Board/notice/detail_view_by__id?sid=" + window.service.cookie.getCookie('session') + "&_id=" + _id
	if( document.getElementById('add_doc_con') ) _el_div__view_container.removeChild( document.getElementById('add_doc_con') );

	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "req_detail_by__id.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		
		var _template = result;

		window.service.Request.req_GET_data__Callback(url,function(result){

			if(result == 0) window.service.session.remove_deleteCookies_location_login();
			var data = JSON.parse( result );

			current_view_doc__data = data[ 0 ];

			if( document.getElementById("view_document") ) _el_div__view_container.removeChild( document.getElementById("view_document") );

			var html_include_data = _template.replace("{{title}}",data[ 0 ].title)
			.replace("{{date}}",make_Array_dateFormat( data[ 0 ].regist_date ) )
			.replace("{{content}}",data[ 0 ].content);

			_el_div__view_container.innerHTML = html_include_data;

			//make_brcm_3();//breadScrumb 만든다;

			if( document.getElementById('add_doc_con') ) document.getElementById("view_container").removeChild(document.getElementById("add_doc_con"));

			//---------- Button;
			var btn_control_obj = {modify : "block", delete : "block"};
			btn_control( btn_control_obj );
			//---------- Button;

			//button 이벤트 연결;
			document.getElementById("modify").addEventListener( "click",modify_doc )
			document.getElementById("delete").addEventListener( "click",function(){
				console.log("asdfasdfasdfasdfasdf")
				delete_doc( current_view_doc__data._id )
			} )
		})
	})
}

/**
 * 서브리스트를 만드는 함수
 * @return {[type]} [description]
 */
var make_sub_list = function( cd$notebook ){

	//----- 리스트높이 자동조절;
	var _h = document.body.clientHeight;
	var header_h = document.getElementById("div-PIMS-HeaderContainer").scrollHeight;
	var footer_h = document.getElementById("footer").scrollHeight;
	var note_add_h = document.getElementById("note_add_container").scrollHeight;
	
	document.getElementById("sub_list").style.height = _h - note_add_h - header_h - footer_h;
	//----- 리스트높이 자동조절;

	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "make_sub_list.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		
		var _template = result;

		var url = "/api/Board/notice/get_list?sid=" + window.service.cookie.getCookie('session') + "&cd$notebook=" + cd$notebook;
		window.service.Request.req_GET_data__Callback(url,function(result){
			if(result == 0) window.service.session.remove_deleteCookies_location_login();

			var data = JSON.parse( result )

			_el_div__sub_list.innerHTML = "";//dom 초기화;

			var regex = /(&nbsp;|<([^>]+)>)/ig

			var i = 0,iLen = data.length,io;
			for(; i<iLen; ++i ){

				io = data[ i ];

				var html_include_data = _template.replace( "{{title}}", io.title )
				.replace( "{{regist_date}}", make_Array_dateFormat( io.regist_date ) )
				.replace("{{content}}", io.content.replace(regex, "").substr(0, 50) );

				_el_div__sub_list.insertAdjacentHTML( 'beforeend', html_include_data );
			}
			document.getElementById( "note_add_container" ).setAttribute( "style", "display : block;" )
			notebook_detail_data = data;

		})

	})
}

/**
 * 프로젝트를 등록한다.
*/
var write_project = function(){

	var project_nm =  document.getElementById("modal_project_nm").value;
	var project_desc = document.getElementById("modal_project_desc").value;

	var url = "/api/Category/project/write?sid=" + window.service.cookie.getCookie('session')
			+ "&project_nm=" + project_nm
			+ "&project_desc=" + project_desc

	window.service.Request.req_GET_data__Callback(url,function(result){
		if(result == 0){
			window.service.session.remove_deleteCookies()
			location.href = "/Member/login";
		}
		var data = JSON.parse( result );

		document.getElementById( "modal_project_nm" ).value = "";
		document.getElementById( "modal_project_desc" ).value = "";
		$('#project_add_modal').modal('hide');

		current_project__data = data;

		make_project_list();
	})
}

/**
 * 노트북을 등록한다.
*/
var write_notebook = function(){

	var notebook_nm =  document.getElementById("modal_notebook_nm").value;
	var notebook_desc = document.getElementById("modal_notebook_desc").value;

	var url = "/api/Category/notebook/write?sid=" + window.service.cookie.getCookie('session')
			+ "&notebook_nm=" + notebook_nm
			+ "&notebook_desc=" + notebook_desc
			+ "&cd$project=" + current_project__data.cd
			+ "&nm$project=" + current_project__data.nm

	window.service.Request.req_GET_data__Callback(url,function(result){
		if(result == 0){
			window.service.session.remove_deleteCookies()
			location.href = "/Member/login";
		}
		var data = JSON.parse( result );

		document.getElementById( "modal_notebook_nm" ).value = "";
		document.getElementById( "modal_notebook_desc" ).value = "";
		$('#notebook_add_modal').modal('hide');

		make_notebook_list( current_project__data.cd );
	})
}

/**
*문서를 등록한다.
*/
var write_doc = function(){

	var url = "/api/Board/notice/write"
	var title = document.getElementById("title").value
	var data = "sid=" + window.service.cookie.getCookie('session')
			+ "&data=" + htmlEntities( encodeURIComponent( CKEDITOR.instances.editor.getData() ) )
			+ "&title=" + encodeURIComponent( title )
			+ "&cd$project=" + current_project__data.cd
			+ "&cd$notebook=" + current_notebook__data.cd;


	window.service.Request.req_POST_data__Callback(url,encodeURI( data ),function( result ){
		if(result == 0) window.service.session.remove_deleteCookies_location_login()

		var data = JSON.parse( result );
		console.log( data );
		console.log( "--등록완료--" );

		_el_div__view_container.removeChild( document.getElementById('add_doc_con') );

		make_sub_list( current_notebook__data.cd );//서브리스트 갱신;

		req_detail_by__id( data._id );//view 데이터 갱신;
	})
}

/**
 * 등록을 취소한다.
 * @return {[type]} [description]
 */
var write_cancel = function(){

	//Dom 삭제;
	document.getElementById("view_container").removeChild(document.getElementById("add_doc_con"));

	if( current_view_doc__data._id ) req_detail_by__id( current_view_doc__data._id )
	var btn_control_obj = {}
	btn_control( btn_control_obj );

	project_sub_nav_sidebar_open();
}

/**
 * 문서를 업데이트 한다.
 * @param  {[type]} data [description]
 * @return {[type]}      [description]
 */
var update_doc = function( data ){

	var url = "/api/Board/notice/update"
	var title = document.getElementById("title").value
	var data = "sid=" + window.service.cookie.getCookie('session')
	+ "&_id=" + current_view_doc__data._id
	+ "&data=" + htmlEntities( encodeURIComponent( CKEDITOR.instances.editor.getData() ) )
	+ "&title=" + encodeURIComponent( title );

	window.service.Request.req_POST_data__Callback(url,encodeURI( data ),function( result){
		if(result == 0){
			window.service.session.remove_deleteCookies()
			location.href = "/Member/login";
		}
		var data = JSON.parse( result );

		console.log( data );
		console.log( "--수정완료--" )

		document.getElementById("view_container").removeChild(document.getElementById("add_doc_con"));

		make_sub_list( current_notebook__data.cd );
		req_detail_by__id( data )
	})
}

/**
 * 
*/

var update_project = function( d ){

	var url = "/api/Category/project/update"
	var data = "sid=" + window.service.cookie.getCookie('session')
	+ "&_id=" + d._id
	+ "&description=" + htmlEntities( encodeURIComponent( d.description ) )
	+ "&nm=" + encodeURIComponent( d.nm );

	window.service.Request.req_POST_data__Callback(url,encodeURI( data ),function( result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		var data = JSON.parse( result );

		console.log( data );
		console.log( "--수정완료--" )
		$('#project_add_modal').modal('toggle');
		make_project_list();
	})
}

/**
 * 
*/

var update_notebook = function( d ){

	var url = "/api/Category/notebook/update"
	var data = "sid=" + window.service.cookie.getCookie('session')
	+ "&_id=" + d._id
	+ "&description=" + htmlEntities( encodeURIComponent( d.description ) )
	+ "&nm=" + encodeURIComponent( d.nm );

	window.service.Request.req_POST_data__Callback(url,encodeURI( data ),function( result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		var data = JSON.parse( result );

		console.log( data );
		console.log( "--수정완료--" )
		make_notebook_list( current_project__data.cd )
		$('#notebook_add_modal').modal('toggle');


		current_notebook__data = d

		document.getElementById("note_add_container").setAttribute("style","display : block;")
		document.getElementById("notebook_title").innerText = current_notebook__data.nm
		document.getElementById("notebook_desc").innerText = current_notebook__data.description

		make_sub_list( current_notebook__data.cd );

		var _t0 = document.getElementById( "view_document" )
		if( _t0 ) if( document.getElementById("view_document").firstChild ) while( document.getElementById("view_document").firstChild ) document.getElementById("view_document").removeChild( _t0.firstChild );

		//make_brcm_2();

	})
}

/**
 * 문서 수정폼을 호출한다.
 * @return {[type]} [description]
 */
var modify_doc = function(){

	//수정폼 로드;
	if( document.getElementById( "view_document" ) ) document.getElementById( "view_document" ).setAttribute("style","display : none;");
	
	//thtml을 호출한다.
	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "add_doc.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		/*
		var markup = '<div><p>text here</p></div>';
		var parser = new DOMParser()
		var el = parser.parseFromString(_template, "text/xml");
		*/
		_el_div__view_container.insertAdjacentHTML( 'beforeend', result );

		//에디터 로드;
		CKEDITOR.replace( 'contents',{
			customConfig : './config.js',
			width: '100%',
			height: '550px',
			toolbarStartupExpanded : false
		});

		//필드초기화;
		document.getElementById("title").value = document.getElementById("view_document_title").innerText;
		CKEDITOR.instances.editor.setData( document.getElementById("view_document_content").innerHTML );

		//----------;
		var btn_control_obj = {
			modify : "block"
			, cancel : "block"
		}
		btn_control( btn_control_obj );
		//----------;

		document.getElementById("modify").removeEventListener("click",modify_doc)
		document.getElementById("modify").addEventListener("click",update_doc)
		document.getElementById("cancel").addEventListener("click", write_cancel );
	})
}

/**
 * 노트북을 삭제한다.
 * @return {[type]} [description]
 */
 var delete_project = function( notebook_id ){

	var url = "/api/Category/project/delete?sid=" + window.service.cookie.getCookie('session')
	+ "&_id=" + notebook_id

	window.service.Request.req_GET_data__Callback(url,function( result ){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();

		console.log( result );
		console.log( "--삭제완료--" )
		
		make_project_list()
	})
}

/**
 * 노트북을 삭제한다.
 * @return {[type]} [description]
 */
var delete_notebook = function( notebook_id ){

	var url = "/api/Category/notebook/delete?sid=" + window.service.cookie.getCookie('session')
	+ "&_id=" + notebook_id

	window.service.Request.req_GET_data__Callback(url,function( result ){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();

		console.log( result );
		console.log( "--삭제완료--" )

		make_notebook_list( current_project__data.cd )
	})
}



/**
 * 문서를 삭제한다.
 * @return {[type]} [description]
 */
var delete_doc = function( doc_id ){

	var url = "/api/Board/notice/delete?sid=" + window.service.cookie.getCookie('session')
	+ "&_id=" + doc_id

	window.service.Request.req_GET_data__Callback(url,function( result ){
		if(result == 0){
			window.service.session.remove_deleteCookies()
			location.href = "/Member/login";
		}
		console.log( result );
		console.log( "--삭제완료--" )

		make_sub_list( current_notebook__data.cd );
		if( document.getElementById("view_document") ) document.getElementById("view_container").removeChild(document.getElementById("view_document"));
	
		//----------;
		var btn_control_obj = {add : "block"}
		btn_control( btn_control_obj );
		//----------;
		/*
		$('#app .ui.sidebar').sidebar('is open');
		$('#app .ui.sidebar').sidebar('is closed');
		$('#app .ui.sidebar').sidebar('is visible');
		$('#app .ui.sidebar').sidebar('is hidden');
		*/
		
		if( $('#app .ui.sidebar').sidebar('is hidden') ) project_sub_nav_sidebar_open();

		document.getElementById("note_add").addEventListener("click", add_doc );
	
	})
}

/**
 * 문서등록폼을 호출한다.
*/
var add_doc = function(){

	$('#app .ui.sidebar').sidebar({context:$('#app')}).sidebar('setting', 'transition', 'push').sidebar('setting', 'dimPage', false).sidebar('hide')

	if( document.getElementById( "view_document" ) ) document.getElementById( "view_document" ).setAttribute("style","display : none;");
	
	//thtml을 호출한다.
	var url1 = "/api/Render/thtml/include_thtml?sid=" + window.service.cookie.getCookie('session') + "&fileNm=" + "add_doc.thtml"
	window.service.Request.req_GET_data__Callback(url1,function(result){
		if(result == 0) window.service.session.remove_deleteCookies_location_login();
		/*
		var markup = '<div><p>text here</p></div>';
		var parser = new DOMParser()
		var el = parser.parseFromString(_template, "text/xml");
		*/
		_el_div__view_container.insertAdjacentHTML( 'beforeend', result );

		//에디터 로드;
		CKEDITOR.replace( 'contents',{
			customConfig : './config.js',
			width: '100%',
			height: '600px',
			toolbarStartupExpanded : false
		});

		//필드초기화;
		document.getElementById("title").value = "";
		CKEDITOR.instances.editor.setData("내용을 입력해주세요")

		//----------;
		var btn_control_obj = {cancel : "block", write : "block"}
		btn_control( btn_control_obj );
		//----------;

		document.getElementById("write").addEventListener("click",write_doc)
		document.getElementById("cancel").addEventListener("click", write_cancel );

	})
}
/**
 * 페이지 초기화;
 * @return {[type]} [description]
 */
var Initialize = function(){

	make_project_list();
	//----------;
	var btn_control_obj = {add : "block"}
	btn_control( btn_control_obj );
	//----------;
	document.getElementById("note_add").addEventListener("click", add_doc );
}

Initialize();

</script>
